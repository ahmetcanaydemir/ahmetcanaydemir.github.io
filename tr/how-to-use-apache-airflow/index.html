<!DOCTYPE html><html lang="tr"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:inherit;border-left-color:inherit;opacity:0.8;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:var(--textLink);text-decoration:none;}a:hover,a:active{text-decoration:underline;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}p code{font-size:1rem;}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}blockquote.translation{font-size:1em;}</style><style data-href="/styles.76dcc336cb9d6b2f62b1.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:url(/static/merriweather-400-i-l-0f46d2fcc8d9674921cd07820a82ed6f.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:url(/static/merriweather-700-l-187d45eaf13b91cf608f3f673ea48f7e.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:url(/static/merriweather-700-i-l-82207a52271f9eac122012812b5d3a37.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:url(/static/merriweather-400-l-ext-7b4d7cd77c7be0ba465786a2b8bb74c9.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:url(/static/montserrat-900-l-ext-906692c68bf177b2067ba48c98ed4f52.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:url(/static/merriweather-400-i-l-ext-1bf3936986258f63a239a7f6054577bf.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:url(/static/merriweather-700-l-ext-cfb1dc4cd427eb7af0e01aa19b3d9bab.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:url(/static/merriweather-700-i-l-ext-1a225383926ba827fcf5113600464352.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:url(/static/merriweather-400-l-fd4fba424d435ed860722c314ec7b5e3.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:url(/static/montserrat-900-l-e6c80823afebb35e16f95ceb0f0be27e.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}.react-toggle{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;background-color:transparent;border:0;cursor:pointer;display:inline-block;padding:0;position:relative;touch-action:pan-x;-webkit-user-select:none;-ms-user-select:none;user-select:none}.react-toggle-screenreader-only{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.react-toggle-track{background-color:#0f1114;border-radius:30px;height:24px;padding:0;transition:all .2s ease;width:50px}.react-toggle-track-check{bottom:0;height:17px;left:5px;line-height:0;margin-bottom:auto;margin-top:auto;opacity:0;position:absolute;top:0;transition:opacity .25s ease;width:17px}.react-toggle--checked .react-toggle-track-check,.react-toggle-track-x{opacity:1;transition:opacity .25s ease}.react-toggle-track-x{bottom:0;height:17px;line-height:0;margin-bottom:auto;margin-top:auto;position:absolute;right:5px;top:0;width:17px}.react-toggle--checked .react-toggle-track-x{opacity:0}.react-toggle-thumb{background-color:#fafafa;border-radius:50%;box-sizing:border-box;height:22px;left:1px;position:absolute;top:1px;-webkit-transform:translateX(0);transform:translateX(0);transition:all .5s cubic-bezier(.23,1,.32,1) 0ms;width:22px}.react-toggle--checked .react-toggle-thumb{border-color:#19ab27;-webkit-transform:translateX(26px);transform:translateX(26px)}.react-toggle--focus .react-toggle-thumb{box-shadow:0 0 2px 3px #ffa7c4}.react-toggle:active .react-toggle-thumb{box-shadow:0 0 5px 5px #ffa7c4}body{--green:#28ab1c;background-color:var(--bg)}body.light{--bg:#fff;--bg-secondary:#f9fafb;--header:#1f871b;--textNormal:#222;--textTitle:#222;--textLink:#1f871b;--hr:rgba(0,0,0,.2);--inlineCode-bg:rgba(255,229,100,.2);--inlineCode-text:#1a1a1a;--form-shadow:0 2px 15px 0 rgba(210,214,220,.5)}body.dark{-webkit-font-smoothing:antialiased;--bg:#282c35;--bg-secondary:#363c48;--header:#fff;--textNormal:hsla(0,0%,100%,.88);--textTitle:#fff;--textLink:var(--green);--hr:hsla(0,0%,100%,.2);--inlineCode-bg:rgba(115,124,153,.2);--inlineCode-text:#e6e6e6;--form-shadow:0 2px 15px 0 rgba(26,26,27,.637)}body:lang(ar) article,body:lang(fa) article,body:lang(he) article{direction:rtl}body:lang(ar) .language-text,body:lang(ar) article .translations,body:lang(ar) article pre,body:lang(fa) .language-text,body:lang(fa) article .translations,body:lang(fa) article pre,body:lang(he) .language-text,body:lang(he) article .translations,body:lang(he) article pre{direction:ltr}body:lang(ar) .language-text,body:lang(fa) .language-text,body:lang(he) .language-text{display:inline-block}body:lang(ar) blockquote,body:lang(fa) blockquote,body:lang(he) blockquote{border-left:unset;border-right:.32813rem solid rgba(0,0,0,.9);margin-left:.75rem;margin-right:-1.75rem;padding-left:unset;padding-right:1.42188rem}body:lang(fa) article,body:lang(fa) header>h1{font-family:Vazir}body:lang(ar) article,body:lang(ar) header>h1{font-family:Cairo,sans-serif}body:lang(ko) article,body:lang(ko) header{word-break:keep-all}code[class*=language-],pre[class*=language-]{-webkit-font-feature-settings:normal;font-feature-settings:normal;word-wrap:normal;background:none;color:#fff;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{overflow:auto;padding:1.3125rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{background:hsla(0,0%,100%,.15);text-shadow:none}:not(pre)>code[class*=language-]{background:var(--inlineCode-bg);border-radius:.3em;color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;border-left:.25em solid #ffa7c4;display:block;padding-left:1.25em;padding-right:1em}.gatsby-highlight,.gatsby-highlight-code-line{margin-left:-1.3125rem;margin-right:-1.3125rem}.gatsby-highlight{-webkit-overflow-scrolling:touch;background:#011627;border-radius:10px;margin-bottom:1.75rem;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}.dropbtn{background-color:#4caf50;border:none;color:#fff;cursor:pointer;font-size:16px;padding:16px}.dropdown{display:inline-block;margin-bottom:0;position:relative}.dropdown-content{background-color:var(--bg-secondary);border-radius:16px;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);display:none;font-size:1rem;min-width:230px;position:absolute;z-index:1}.dropdown-content a{color:var(--textNormal);display:block;padding:4px 22px;text-decoration:none}.dropdown-content a:hover{background-color:var(--bg)}.dropdown-content a.selected{background-color:var(--bg);color:var(--textLink);pointer-events:none}.dropdown:hover .dropdown-content{display:block}.dropdown:hover:after{content:"";height:30px;left:0;position:absolute;top:calc(100% - 30px);width:230px}</style><meta name="generator" content="Gatsby 4.4.0"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Ahmet Can Aydemir&#x27;s Personal Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=478b5d01d3b7e74285a448d45abb5447" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=478b5d01d3b7e74285a448d45abb5447"/><title data-react-helmet="true">Apache Airflow Nasıl Kullanılır — Ahmet Can Aydemir</title><meta data-react-helmet="true" name="theme-color" content="#282c35"/><meta data-react-helmet="true" name="description" content="Apache Airflow nedir ve nasıl kullanılır."/><meta data-react-helmet="true" property="og:url" content="https://ahmetcan.org/tr/how-to-use-apache-airflow/"/><meta data-react-helmet="true" property="og:title" content="Apache Airflow Nasıl Kullanılır"/><meta data-react-helmet="true" property="og:description" content="Apache Airflow nedir ve nasıl kullanılır."/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@ahmetcnaydemir"/><meta data-react-helmet="true" name="twitter:title" content="Apache Airflow Nasıl Kullanılır"/><meta data-react-helmet="true" name="twitter:description" content="Apache Airflow nedir ve nasıl kullanılır."/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-4938fdd98f676fdb086f.js"/><link as="script" rel="preload" href="/framework-284342f1907d997d438f.js"/><link as="script" rel="preload" href="/app-79b145741620feb1a746.js"/><link as="script" rel="preload" href="/9c5c3b1714a076345eeea19da4bc8b5e8ba4ff9d-6099e8baeb69a0e60309.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-aa7a80216bd6d962f59b.js"/><link as="fetch" rel="preload" href="/page-data/tr/how-to-use-apache-airflow/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/336482444.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body class="light"><script>
              (function() {
                window.__onThemeChange = function() {};
                function setTheme(newTheme) {
                  window.__theme = newTheme;
                  preferredTheme = newTheme;
                  document.body.className = newTheme;
                  window.__onThemeChange(newTheme);
                }

                var preferredTheme;
                try {
                  preferredTheme = localStorage.getItem('theme');
                } catch (err) { }

                window.__setPreferredTheme = function(newTheme) {
                  setTheme(newTheme);
                  try {
                    localStorage.setItem('theme', newTheme);
                  } catch (err) {}
                }

                var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
                darkQuery.addListener(function(e) {
                  window.__setPreferredTheme(e.matches ? 'dark' : 'light')
                });

                setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
              })();
            </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="color:var(--textNormal);background:var(--bg);transition:color 0.2s ease-out, background 0.2s ease-out;min-height:100vh"><div style="margin-left:auto;margin-right:auto;max-width:48.75rem;padding:2.625rem 1.21875rem"><header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2.625rem"><div style="font-size:1.68179rem;line-height:2.4375rem;margin-bottom:0;margin-top:0;border:0"><a style="box-shadow:none;text-decoration:none;color:var(--textTitle);margin-right:5px" aria-label="Home" href="/"><svg aria-hidden="true" data-prefix="fas" width="20" height="20" data-icon="home" class="prefix__svg-inline--fa prefix__fa-home prefix__fa-w-18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0016 16l112.06-.29a16 16 0 0015.92-16V368a16 16 0 0116-16h64a16 16 0 0116 16v95.64a16 16 0 0016 16.05L464 480a16 16 0 0016-16V300L295.67 148.26a12.19 12.19 0 00-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 00-12-12h-56a12 12 0 00-12 12v72.61L318.47 43a48 48 0 00-61 0L4.34 251.47a12 12 0 00-1.6 16.9l25.5 31A12 12 0 0045.15 301l235.22-193.74a12.19 12.19 0 0115.3 0L530.9 301a12 12 0 0016.9-1.6l25.5-31a12 12 0 00-1.7-16.93z"></path></svg></a><div class="dropdown"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" cursor="pointer" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="prefix__feather prefix__feather-chevron-down"><path d="M6 9l6 6 6-6"></path></svg><div class="dropdown-content"><a class="false" href="/about">About</a><a class="false" href="/projects">Projects</a><a class="false" href="/books">Books</a><a class="false" href="/watched">Watched</a></div></div></div><div style="height:24px"></div></header><main><article><header><h1 style="color:var(--textTitle)">Apache Airflow Nasıl Kullanılır</h1><p style="font-size:0.87055rem;line-height:1.625rem;display:block;margin-bottom:1.625rem;margin-top:-1.3rem">16 Mart 2022<!-- --> • 9 min read</p><div class="translations"><div style="font-size:0.9em;border:1px solid var(--hr);border-radius:0.75em;padding:0.75em;background:var(--inlineCode-bg);word-break:keep-all;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"><span><span style="display:block">Written in:<!-- --> <a href="/how-to-use-apache-airflow/">English</a> • <b>Türkçe</b></span></span><div style="margin-top:0.54167rem"><a href="/tr">Tüm Türkçe gönderileri göster</a> </div></div></div></header><div><h2 id="apache-airflow-nedir" style="position:relative;"><a href="#apache-airflow-nedir" aria-label="apache airflow nedir permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apache Airflow Nedir</h2>
<p>Airflow; taskları doğru zamanda, doğru sırayla ve doğru bir şekilde çalıştırmayı sağlayan bir orkestrasyon aracıdır.</p>
<h3 id="apache-airflowa-neden-i̇htiyaç-var" style="position:relative;"><a href="#apache-airflowa-neden-i%CC%87htiya%C3%A7-var" aria-label="apache airflowa neden i̇htiyaç var permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apache Airflow’a Neden İhtiyaç Var</h3>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m9803a05zin2dg81g3gs.png" alt="ETL"></p>
<p>Yukarıdaki gibi bir data pipelinea sahip olduğunuzu hayal edin.</p>
<ul>
<li>Bu aşamaların herhangi birinde hata oluşursa ne olacak? Veriyi çektiğiniz API’da hata olabilir, veriyi işleme sırasında hata olabilir veya DB’ye kayıt sırasında bir hata olabilir.</li>
<li>Buna benzer bir sürü data pipelinea sahipseniz eninde sonunda işin içinden çıkılmaz bir hal alacaktır.</li>
</ul>
<p>Kabaca, yukarıdaki örnekteki gibi verinin bir kaynaktan alınıp belirli işlemlerden geçirildikten sonra hedefe kaydedilmesi işlemlerine ETL(Extract Transform Load) denir. Airflow kullanılarak bu gibi işlemler gelişmiş bir şekilde yönetilebilirler.</p>
<h3 id="apache-airflowun-faydaları" style="position:relative;"><a href="#apache-airflowun-faydalar%C4%B1" aria-label="apache airflowun faydaları permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apache Airflow’un Faydaları</h3>
<p><strong>Dinamik:</strong> Python ile ne yapılabiliyorsa airflow ile de yapılabiliyor bu da tasklarımızı oluştururken muazzam bir dinamiklik sağlıyor.</p>
<p><strong>Ölçeklendirilebilir:</strong> İstenilen kadar task kolayca paralel çalıştırılabiliyor.</p>
<p><strong>Kullanıcı Arayüzü:</strong> Kullanışlı bir UI’a sahip. Data pipelinelarda oluşan hatalar ve nerede oluştuğu kolayca gözlemlenebiliyor. Hata alan tasklar yeniden başlatlabiliyor.</p>
<p><strong>Genişletilebilir:</strong> Yeni bir araç çıktığında Airflow’un güncellenmesini beklemek gerekmiyor. Kendi eklentilerinizi yazıp kolayca entegre edebiliyorsunuz.</p>
<h3 id="airflow-temel-bileşenleri" style="position:relative;"><a href="#airflow-temel-bile%C5%9Fenleri" aria-label="airflow temel bileşenleri permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Airflow Temel Bileşenleri</h3>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/zqxxkmass3ie637tzjvd.png" alt="Airflow&#x27;s Core Components"></p>
<p><strong>Web Server:</strong> Flask sunucusu UI’ı serve ediyor.</p>
<p><strong>Scheduler:</strong> Workflowları schecudle eden deamon. Airflow’un en önemli componentidir.</p>
<p><strong>Metastore:</strong> Metadata’nın saklandığı veritabanı.</p>
<p><strong>Executor:</strong> Taskların nasıl çalışması gerektiğinin tanımlandığı sınıf.</p>
<p><strong>Worker:</strong> Taskı execute eden process veya sub proccess</p>
<h3 id="dag-directed-acyclic-graph" style="position:relative;"><a href="#dag-directed-acyclic-graph" aria-label="dag directed acyclic graph permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DAG (Directed Acyclic Graph)</h3>
<p>DAG Airflow’un temel konseptidir. Taskları, bağımlılık ve ilişkileri ile bir araya getirip nasıl çalışmalarını söyler.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/mldbmor2s91ffb7ho5z5.png" alt="DAG"></p>
<ul>
<li>Örnekteki DAG, dört task tanımlar (A, B, C ve D) ve hangi taskların yürütülmesi gerektiğini, hangi görevlerin diğerlerine bağlı olduğunu belirtir. Ayrıca ne sıklıkta çalıştırılacağını da söyler - örneğin “yarından itibaren her 5 dakikada bir” veya “1 Ocak 2020’den itibaren her gün”.</li>
<li>DAG, görevlerin içinde neler olduğuyla ilgilenmez; yalnızca bunların nasıl yürütüleceğiyle - çalıştırma sırası, kaç kez yeniden deneneceği, zaman aşımları vs. ile ilgilenir.</li>
</ul>
<p><strong>Örnek bir DAG tanımı</strong></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">with</span> DAG<span class="token punctuation">(</span><span class="token string">"my_dag_name"</span><span class="token punctuation">,</span>
		start_date<span class="token operator">=</span>datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    schedule_interval<span class="token operator">=</span><span class="token string">"@daily"</span><span class="token punctuation">,</span>
		catchup<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">as</span> dag<span class="token punctuation">:</span>
    op <span class="token operator">=</span> DummyOperator<span class="token punctuation">(</span>task_id<span class="token operator">=</span><span class="token string">"task"</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="operator" style="position:relative;"><a href="#operator" aria-label="operator permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Operator</h3>
<p>Operator taskı kapsayan bir wrapperdır. Varsayılan olarak farklı tipte birçok operator bulunur ve <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/index.html" target="_blank" rel="nofollow noopener noreferrer">bu bağlantıdan</a> incelenebilir. Ayrca <a href="https://airflow.apache.org/docs/apache-airflow-providers/operators-and-hooks-ref/index.html" target="_blank" rel="nofollow noopener noreferrer">çok daha fazlası</a> da ihtiyaca göre eklenebilir.</p>
<ol>
<li><strong>Action Operators:</strong> Fonksyionları veya komutları execute ettiğimiz operatorler örn: <code class="language-text">bash scriptleri</code>, <code class="language-text">python kodu</code></li>
<li><strong>Transfer Operators:</strong> Kaynaktan hedefe veri taşımaya yarayan operatorler örn: <code class="language-text">ElasticSearch to Mysql</code></li>
<li><strong>Sensor Operators:</strong> Başka bir işleme geçmeden önce bir şeyin olmasını beklemek için kullanılan operatorler örn: bir dizinde dosya var mı diye bekleyip, varsa diğer taska geçmek.</li>
</ol>
<h3 id="apache-airflow-ne-değildir" style="position:relative;"><a href="#apache-airflow-ne-de%C4%9Fildir" aria-label="apache airflow ne değildir permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apache Airflow ne değildir?</h3>
<p>Airflow data streaming çözümü veya data processing frameworkü değildir. Eğer her saniye veri işlemeniz gerekiyorsa Airflow kullanmak yerine Spark veya Flink daha doğru bir çözüm olacaktır. Eğer terabaytlarca veri işleniyorsa yine Airflow üzerinden operator ile Spark job’ı çalıştırılması tavsiye edilir.</p>
<h2 id="airflow-kurulumu" style="position:relative;"><a href="#airflow-kurulumu" aria-label="airflow kurulumu permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Airflow Kurulumu</h2>
<p>Airflow docker, kubernetes veya farklı yöntemlerle kurulabilse de bu yazımda en basit şekliyle standalone kurulum yapabiliriz.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># Airflow bir home dizinine ihtiyaç duyar. Varsayılan dizin `~/airflow` ama isteğe bağlı olarak değiştirilebilir.</span>
export AIRFLOW_HOME<span class="token operator">=</span><span class="token operator">~</span><span class="token operator">/</span>airflow

<span class="token comment"># Uygun constraint dosyasının bağlantısı ile airflow'u kurun. Bu örnekte Python 3.6 için Airflow 2.2.4 kurulumu yapıyoruz.</span>
pip install <span class="token string">"apache-airflow==${AIRFLOW_VERSION}"</span> <span class="token operator">-</span><span class="token operator">-</span>constraint <span class="token string">"https://raw.githubusercontent.com/apache/airflow/constraints-2.2.4/constraints-3.6.txt"</span>

<span class="token comment"># Aşağıdaki komut sizin için veritabanı oluşturacak, bir kullanıcı oluşturacak ve gerekli tüm bileşenleri başlatacak.</span>
airflow standalone

<span class="token comment"># Tarayıcınızdan localhost:8080 adresini ziyaret edin</span>
<span class="token comment"># ve terminaldeki admin kullanıcı adı ve şifresini kullanarak giriş yapın.</span>
<span class="token comment"># Çalıştığından emin olmak için anasayfadaki `example_bash_operator` isimli örnek DAG'ı etkinleştirebilirsiniz.</span></code></pre></div>
<h2 id="apache-airflow-ile-i̇lk-pipeline" style="position:relative;"><a href="#apache-airflow-ile-i%CC%87lk-pipeline" aria-label="apache airflow ile i̇lk pipeline permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apache Airflow ile İlk Pipeline</h2>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/l4of3ly2k0c3zaqi00o9.png" alt="Pipeline"></p>
<p>Örneğin şekildeki gibi bir data pipelineı airflow kullanarak oluşturalım. Bunun için <code class="language-text">~/airflow/dags</code> dizinine yeni bir python dosyası oluşturalım örn: <code class="language-text">user_processing.py</code></p>
<h3 id="1-modullerin-import-edilmesi" style="position:relative;"><a href="#1-modullerin-import-edilmesi" aria-label="1 modullerin import edilmesi permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Modullerin Import Edilmesi</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pandas <span class="token keyword">import</span> json_normalize

<span class="token comment"># DAG nesnesi; DAG oluşturmak için buna ihtiyacmız olacak</span>
<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG

<span class="token comment"># Operatorler</span>
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>sqlite <span class="token keyword">import</span> SqliteOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>http <span class="token keyword">import</span> SimpleHttpOperator

<span class="token comment"># Sensorler</span>
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>sensors<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpSensor</code></pre></div>
<h3 id="2-dag-nesnesini-oluşturma" style="position:relative;"><a href="#2-dag-nesnesini-olu%C5%9Fturma" aria-label="2 dag nesnesini oluşturma permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. DAG Nesnesini Oluşturma</h3>
<p>Tasklarımızı tanımlamak için bir DAG nesnesine ihtiyacımız olacak. DAG için benzersiz bir tanımlayıcı olan dag_id için bir değer giriyoruz örneğin <code class="language-text">user_processing</code>. Varsayılan argümanları ve taskın çalışacağı zamanlama aralığını belirtiyoruz.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">default_args <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'start_date'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">with</span> DAG<span class="token punctuation">(</span><span class="token string">'user_processing'</span><span class="token punctuation">,</span> schedule_interval<span class="token operator">=</span><span class="token string">'@daily'</span><span class="token punctuation">,</span>
        default_args<span class="token operator">=</span>default_args<span class="token punctuation">,</span>
        catchup<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

        <span class="token comment"># Define tasks/operators</span></code></pre></div>
<h3 id="3-sqlite-tablosunu-oluşturma" style="position:relative;"><a href="#3-sqlite-tablosunu-olu%C5%9Fturma" aria-label="3 sqlite tablosunu oluşturma permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. SQLite Tablosunu Oluşturma</h3>
<p>Bu task için <code class="language-text">SqliteOperator</code> kulanabiliriz. Fakat <code class="language-text">SqliteOperator</code> bizden conn_id isimli bir parametre isteyecek bu yüzden öncelikle SQLite DB için connection oluşturalım.</p>
<p>Airflow’da connectionlar için metadata veritabanında tutulur böylece sadece conn_id kullanırız ve kod tekrarı da olmaz. Aynı işlemi HTTPOperator’u için de yapmamız gerekecek.</p>
<p>Connection oluşturmak için UI’ı kullanabiliriz</p>
<ol>
<li><a href="http://localhost:8080/connection/add" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/connection/add</a> bağlantısına gidin (<strong>Admin / Connections / +</strong>)</li>
<li><code class="language-text">Conn Id</code> alanına benzersiz bir isim verin örn: <code class="language-text">db_sqlite</code></li>
<li><code class="language-text">Conn Type</code> alanında <code class="language-text">SQLite</code> seçin</li>
<li><code class="language-text">Host</code> alanına SQLite veritabanı dosyasının yolunu yazın. Bu örnekte yeni bir SQLite veritabanı dosyası oluşturmak yerine Airflow’un metadata veritabanını kullanabiliriz. <code class="language-text">/home/airflow/airflow.db</code></li>
<li>Kaydedin</li>
</ol>
<p>Bu işlemden sonra operator’ü oluşturabiliriz. Her operator benzersiz bir <code class="language-text">task_id</code>’ye sahip olmalıdır. SqliteOperator ayrıca <code class="language-text">sqlite_conn_id</code> ve <code class="language-text">sql</code> parametrelerine de sahip. <code class="language-text">sqlite_conn_id</code> olarak az önce oluşturduğumuz <code class="language-text">db_sqlite</code>‘ı kullanacağız.</p>
<p>SQL kodu eğer zaten <code class="language-text">users</code> tablosu yoksa; <code class="language-text">firstname</code>, <code class="language-text">lastname</code>, <code class="language-text">country</code>, <code class="language-text">username</code>, <code class="language-text">password</code> ve <code class="language-text">email</code> alanlarına sahip bir <code class="language-text">users</code> tablosu oluşturuyor.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"> creating_table <span class="token operator">=</span> SqliteOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'creating_table'</span><span class="token punctuation">,</span>
        sqlite_conn_id<span class="token operator">=</span><span class="token string">'db_sqlite'</span><span class="token punctuation">,</span>
        sql<span class="token operator">=</span><span class="token triple-quoted-string string">'''
            CREATE TABLE IF NOT EXISTS users (
                firstname TEXT NOT NULL,
                lastname TEXT NOT NULL,
                country TEXT NOT NULL,
                username TEXT NOT NULL,
                password TEXT NOT NULL,
                email TEXT NOT NULL PRIMARY KEY
            );
        '''</span> 
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="4-api-kontrolü" style="position:relative;"><a href="#4-api-kontrol%C3%BC" aria-label="4 api kontrolü permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. API Kontrolü</h3>
<p>HTTP isteği atarak API’da bir sorun var mı yok mu diye kontrol etmek için bir sensor ekleyebiliriz. Bunun için <code class="language-text">HttpSensor</code> kullanışlı olacaktır fakat <code class="language-text">HttpSensor</code>, <code class="language-text">http_conn_id</code> parametresine ihtiyaç duyuyor. Bu yüzden bir önceki adımda yaptığımız gibi yeni bir connection oluşturmalıyız. Öncekinden farklı olarak bu kez <code class="language-text">SQLite</code> tipinde değil <code class="language-text">HTTP</code> tipinde bir connection oluşturacağız.</p>
<p>Connection oluşturmak için UI’ı kullanabiliriz</p>
<ol>
<li><a href="http://localhost:8080/connection/add" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/connection/add</a> bağlantısına gidin (<strong>Admin / Connections / +</strong>)</li>
<li><code class="language-text">Conn Id</code> alanına benzersiz bir isim verin örn: <code class="language-text">user_api</code></li>
<li><code class="language-text">Conn Type</code> alanında <code class="language-text">HTTP</code> seçin</li>
<li><code class="language-text">Host</code> alanına rastgele kullanıcı getiren API’ın adresini girin. örn <a href="https://randomuser.me/api" target="_blank" rel="nofollow noopener noreferrer"><code class="language-text">https://randomuser.me/</code></a></li>
<li>Kaydedin</li>
</ol>
<p>Artık sensoru oluşturabiliriz. Bizim kullandığımız API <a href="https://randomuser.me/api" target="_blank" rel="nofollow noopener noreferrer"><code class="language-text">https://randomuser.me/api/</code></a> adresinde çalıştığı için endpoint parametresinde <code class="language-text">api/</code> yazıyor</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">is_api_available <span class="token operator">=</span> HttpSensor<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'is_api_available'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span>
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="5-apidan-rastgele-kullanıcı-getirme" style="position:relative;"><a href="#5-apidan-rastgele-kullan%C4%B1c%C4%B1-getirme" aria-label="5 apidan rastgele kullanıcı getirme permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. API’dan Rastgele Kullanıcı Getirme</h3>
<p><code class="language-text">SimpleHttpOperator</code> kullanarak daha önce oluşturduğumuz <code class="language-text">user_api</code> connectionına <code class="language-text">GET</code> HTTP isteği gönderiyoruz. <code class="language-text">response_filter</code> ile <code class="language-text">response.text</code> alanındaki json stringini python objesine çeviriyoruz.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"> extracting_user <span class="token operator">=</span> SimpleHttpOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'extracting_user'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span><span class="token punctuation">,</span>
        method<span class="token operator">=</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
        response_filter<span class="token operator">=</span><span class="token keyword">lambda</span> response<span class="token punctuation">:</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>
        log_response<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="6-api-sonucunu-i̇şleme" style="position:relative;"><a href="#6-api-sonucunu-i%CC%87%C5%9Fleme" aria-label="6 api sonucunu i̇şleme permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. API Sonucunu İşleme</h3>
<p><code class="language-text">PythonOperator</code> kullanarak 5. adımda elde ettiğimiz python objesinin sadece istediğimiz alanlarını csv dosyasına kaydedeceğiz.</p>
<p><code class="language-text">python_callable</code> parametresi ile doğrudana python methodu çalıştırılabilir.</p>
<p>Buradaki önemli kısım bir önceki bölümdeki response’u nasıl alacağımızdır. Bunun için <code class="language-text">task instance (ti)</code> nesnesini parametre olarak python fonksiyonuna yazabiliriz ve <code class="language-text">users = ti.xcom_pull(task_ids=['extracting_user'])</code> ile verdiğimiz <code class="language-text">task_ids</code>lerin sonuçlarını elde edebiliriz.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">processing_user <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'processing_user'</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>_processing_user
    <span class="token punctuation">)</span>

<span class="token comment"># DAG kapsamının dışında bir yerde</span>
<span class="token keyword">def</span> <span class="token function">_processing_user</span><span class="token punctuation">(</span>ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    users <span class="token operator">=</span> ti<span class="token punctuation">.</span>xcom_pull<span class="token punctuation">(</span>task_ids<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'extracting_user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">len</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'results'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'User is empty'</span><span class="token punctuation">)</span>
    user <span class="token operator">=</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'results'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    processed_user <span class="token operator">=</span> json_normalize<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'firstname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'lastname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'last'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'country'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'email'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    processed_user<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/tmp/processed_user.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="7-i̇şlenmiş-kullanıcıları-sqlite-dbye-kaydetme" style="position:relative;"><a href="#7-i%CC%87%C5%9Flenmi%C5%9F-kullan%C4%B1c%C4%B1lar%C4%B1-sqlite-dbye-kaydetme" aria-label="7 i̇şlenmiş kullanıcıları sqlite dbye kaydetme permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. İşlenmiş Kullanıcıları SQLite DB’ye Kaydetme</h3>
<p>Burada da farklılık olsun diye <code class="language-text">BashOperator</code> kullanabiliriz. <code class="language-text">BashOperator</code> bash komutları çalıştırmamızı sağlar.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">storing_user <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'storing_user'</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">'echo -e ".separator ","\n.import /tmp/processed_user.csv users" | sqlite3 /home/airflow/airflow/airflow.db'</span>
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="8-tasklar-arasındaki-i̇lişki" style="position:relative;"><a href="#8-tasklar-aras%C4%B1ndaki-i%CC%87li%C5%9Fki" aria-label="8 tasklar arasındaki i̇lişki permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. Tasklar Arasındaki İlişki</h3>
<p>Basitçe aşağıdaki şekilde taskların yönü ve birbirleri ile bağlantısını tanımlanabilir.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># DAG kapsamının dışında bir yerde</span>
creating_table <span class="token operator">>></span> is_api_available <span class="token operator">>></span> extracting_user <span class="token operator">>></span> processing_user <span class="token operator">>></span> storing_user</code></pre></div>
<h3 id="tamamlanmış-dag-dosyası" style="position:relative;"><a href="#tamamlanm%C4%B1%C5%9F-dag-dosyas%C4%B1" aria-label="tamamlanmış dag dosyası permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tamamlanmış DAG Dosyası</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pandas <span class="token keyword">import</span> json_normalize

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG

<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>sqlite <span class="token keyword">import</span> SqliteOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>http <span class="token keyword">import</span> SimpleHttpOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>sensors<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpSensor

default_args <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'start_date'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">_processing_user</span><span class="token punctuation">(</span>ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    users <span class="token operator">=</span> ti<span class="token punctuation">.</span>xcom_pull<span class="token punctuation">(</span>task_ids<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'extracting_user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">len</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'results'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'User is empty'</span><span class="token punctuation">)</span>
    user <span class="token operator">=</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'results'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    processed_user <span class="token operator">=</span> json_normalize<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'firstname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'lastname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'last'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'country'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'email'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    processed_user<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/tmp/processed_user.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    

<span class="token keyword">with</span> DAG<span class="token punctuation">(</span><span class="token string">'user_processing'</span><span class="token punctuation">,</span> schedule_interval<span class="token operator">=</span><span class="token string">'@daily'</span><span class="token punctuation">,</span>
        default_args<span class="token operator">=</span>default_args<span class="token punctuation">,</span>
        catchup<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>
        <span class="token comment"># Define tasks/operators</span>
        
    creating_table <span class="token operator">=</span> SqliteOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'creating_table'</span><span class="token punctuation">,</span>
        sqlite_conn_id<span class="token operator">=</span><span class="token string">'db_sqlite'</span><span class="token punctuation">,</span>
        sql<span class="token operator">=</span><span class="token triple-quoted-string string">'''
            CREATE TABLE IF NOT EXISTS users (
                firstname TEXT NOT NULL,
                lastname TEXT NOT NULL,
                country TEXT NOT NULL,
                username TEXT NOT NULL,
                password TEXT NOT NULL,
                email TEXT NOT NULL PRIMARY KEY
            );
        '''</span> 
    <span class="token punctuation">)</span>
    
    is_api_available <span class="token operator">=</span> HttpSensor<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'is_api_available'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span>
    <span class="token punctuation">)</span>
    
    extracting_user <span class="token operator">=</span> SimpleHttpOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'extracting_user'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span><span class="token punctuation">,</span>
        method<span class="token operator">=</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
        response_filter<span class="token operator">=</span><span class="token keyword">lambda</span> response<span class="token punctuation">:</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>
        log_response<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span>
    
    processing_user <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'processing_user'</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>_processing_user
    <span class="token punctuation">)</span>
    
    storing_user <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'storing_user'</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">'echo -e ".separator ","\n.import /tmp/processed_user.csv users" | sqlite3 /home/airflow/airflow/airflow.db'</span>
    <span class="token punctuation">)</span>
    
creating_table <span class="token operator">>></span> is_api_available <span class="token operator">>></span> extracting_user <span class="token operator">>></span> processing_user <span class="token operator">>></span> storing_user</code></pre></div>
<h2 id="sonuç" style="position:relative;"><a href="#sonu%C3%A7" aria-label="sonuç permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sonuç</h2>
<p>Konsepti anlamak adına basit ve paralellik gerektirmeyen bir datapipeline tanımlamış olduk. Airflow kullanılarak çok daha kompleks, paralel tasklar oluşturulabilir. Okuduğunuz için teşekkürler!</p>
<h2 id="ekran-görüntüleri" style="position:relative;"><a href="#ekran-g%C3%B6r%C3%BCnt%C3%BCleri" aria-label="ekran görüntüleri permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ekran Görüntüleri</h2>
<details>
<summary markdown="span">Ekran Görüntülerini Göster</summary>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/a3a0r96acrkak6cfceck.png" alt="Graph View"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gc2uehcap4a2azidlppc.png" alt="Tree View"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/j68phdyzzbll0wfx7q6q.png" alt="Gantt"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/5vjunmrg6fd6gq0gg5wi.png" alt="Log"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m6rb1hz3e4qs1pmdpc53.png" alt="Homepage"></p>
</details>
<h2 id="kaynaklar" style="position:relative;"><a href="#kaynaklar" aria-label="kaynaklar permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kaynaklar</h2>
<ul>
<li><a href="https://www.udemy.com/course/the-complete-hands-on-course-to-master-apache-airflow/" target="_blank" rel="nofollow noopener noreferrer">The Complete Hands-On Introduction to Apache Airflow by Marc Lamberti</a></li>
<li><a href="https://airflow.apache.org/docs/" target="_blank" rel="nofollow noopener noreferrer">Apache Airflow Docs</a></li>
</ul></div><footer></footer></article></main><aside><div style="margin:90px 0 40px 0;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"></div><div style="display:flex;margin-bottom:3.25rem"><img src="/static/profile-pic-a7e6f09e74346211c0c48d9c8b0ae26a.jpg" alt="Ahmet Can Aydemir" style="margin-bottom:0;margin-right:0.8125rem;width:3.25rem;height:3.25rem;border-radius:50%"/><p style="max-width:420px">Personal blog by<!-- --> <a href="https://mobile.twitter.com/ahmetcnaydemir">Ahmet Can Aydemir</a>.<br/>My thoughts about Programming and things.</p></div><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li></li><li></li></ul></nav></aside></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-43958449-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tr/how-to-use-apache-airflow/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2a3acc3892700f85b191.js"],"app":["/app-79b145741620feb1a746.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-12da092de1793550498c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-ca4f78e840fcfaf7f05a.js"],"component---src-pages-about-js":["/component---src-pages-about-js-98e18466907b2d737eb0.js"],"component---src-pages-books-js":["/component---src-pages-books-js-28107fe99183231cdf1f.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-a6996f251c6d479c9a40.js"],"component---src-pages-watched-js":["/component---src-pages-watched-js-532656bc23361b9cd4dd.js"],"component---src-templates-blog-index-js":["/component---src-templates-blog-index-js-0fa76496225da6334fd6.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-aa7a80216bd6d962f59b.js"]};/*]]>*/</script><script src="/polyfill-2a3acc3892700f85b191.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-aa7a80216bd6d962f59b.js" async=""></script><script src="/9c5c3b1714a076345eeea19da4bc8b5e8ba4ff9d-6099e8baeb69a0e60309.js" async=""></script><script src="/app-79b145741620feb1a746.js" async=""></script><script src="/framework-284342f1907d997d438f.js" async=""></script><script src="/webpack-runtime-4938fdd98f676fdb086f.js" async=""></script></body></html>