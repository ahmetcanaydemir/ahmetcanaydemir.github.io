{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/krakend-monitoring-with-grafana/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Ahmet Can Aydemir","author":"Ahmet Can Aydemir"}},"markdownRemark":{"id":"1badfd60-523c-5d16-b6b3-439f5f51e655","html":"<p>KrakenD is an ultra-performant open-source Gateway that can transform, aggregate, or remove data from multiple services, with linear scalability.</p>\n<p>I will explain how to monitor the status of KrakenD services with the Grafana dashboard.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8addae8b8eebf375cfaa28c5d2363444/f84cf/grafana-krakend.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.567567567567565%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeSgrI//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAEAAQUAAAAAAAAAAAAAAAAAIRARQVFh/9oACAEBAAE/IbIR1lqn/9oADAMBAAIAAwAAABAgz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAgMAAAAAAAAAAAAAAAEAESExcdHw/9oACAEBAAE/EEWlN3mBUWxdUEfQdx25jqGf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"KrakenD Grafana Dashboard\"\n        title=\"KrakenD Grafana Dashboard\"\n        src=\"/static/8addae8b8eebf375cfaa28c5d2363444/1c72d/grafana-krakend.jpg\"\n        srcset=\"/static/8addae8b8eebf375cfaa28c5d2363444/a80bd/grafana-krakend.jpg 148w,\n/static/8addae8b8eebf375cfaa28c5d2363444/1c91a/grafana-krakend.jpg 295w,\n/static/8addae8b8eebf375cfaa28c5d2363444/1c72d/grafana-krakend.jpg 590w,\n/static/8addae8b8eebf375cfaa28c5d2363444/f84cf/grafana-krakend.jpg 880w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Instead of creating a dashboard from scratch, we can use one of the pre-configured dashboards available on grafana.com. In this article, we will use the KrakenD dashboard with ID 5722, prepared by <code class=\"language-text\">dlopez</code>. If you want, you can customize the dashboard according to your needs.</p>\n<p>By default, this dashboard provides us with the following metrics:</p>\n<ul>\n<li>Requests from users to KrakenD</li>\n<li>Requests from KrakenD to your backends</li>\n<li>Response times</li>\n<li>Memory usage and details</li>\n<li>Endpoints and status codes</li>\n<li>Heatmaps</li>\n<li>Open connections</li>\n<li>Throughput</li>\n<li>Distributions, timers, garbage collection, etc.</li>\n</ul>\n<h2 id=\"prerequisites\" style=\"position:relative;\"><a href=\"#prerequisites\" aria-label=\"prerequisites permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prerequisites</h2>\n<ul>\n<li>KrakenD</li>\n</ul>\n<hr>\n<h2 id=\"influxdb-setup\" style=\"position:relative;\"><a href=\"#influxdb-setup\" aria-label=\"influxdb setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>InfluxDB Setup</h2>\n<p>The dashboard we will use uses InfluxDB to read metric data. You can easily run InfluxDB with Docker.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> run -p <span class=\"token number\">8086</span>:8086 <span class=\"token punctuation\">\\</span> \n  -e <span class=\"token assign-left variable\">INFLUXDB_DB</span><span class=\"token operator\">=</span>krakend <span class=\"token punctuation\">\\</span> \n  -e <span class=\"token assign-left variable\">INFLUXDB_USER</span><span class=\"token operator\">=</span>myusername -e <span class=\"token assign-left variable\">INFLUXDB_USER_PASSWORD</span><span class=\"token operator\">=</span>mypassword <span class=\"token punctuation\">\\</span> \n  -e <span class=\"token assign-left variable\">INFLUXDB_ADMIN_USER</span><span class=\"token operator\">=</span>admin -e <span class=\"token assign-left variable\">INFLUXDB_ADMIN_PASSWORD</span><span class=\"token operator\">=</span>myadminpassword <span class=\"token punctuation\">\\</span> \n  -d --name<span class=\"token operator\">=</span>influx-1.8 <span class=\"token punctuation\">\\</span> \n  influxdb:1.8 </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> -it influx-1.8 /bin/bash</code></pre></div>\n<hr>\n<h2 id=\"grafana-setup\" style=\"position:relative;\"><a href=\"#grafana-setup\" aria-label=\"grafana setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Grafana Setup</h2>\n<p>If Grafana is not installed, you run it with Docker. After the following command, Grafana will be running at <code class=\"language-text\">http://localhost:3000</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> run <span class=\"token punctuation\">\\</span> \n  -d <span class=\"token punctuation\">\\</span> \n  -p <span class=\"token number\">3000</span>:3000 <span class=\"token punctuation\">\\</span> \n  --name<span class=\"token operator\">=</span>grafana <span class=\"token punctuation\">\\</span> \n  grafana/grafana </code></pre></div>\n<hr>\n<h2 id=\"krakend-configuration\" style=\"position:relative;\"><a href=\"#krakend-configuration\" aria-label=\"krakend configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>KrakenD Configuration</h2>\n<p>Add the following configuration to your krakend.json at the root level. After this, your KrakenD metrics will start saving to InfluxDB at <code class=\"language-text\">&lt;your-influx-db-server-ip>:8086</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"extra_config\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"github_com/letgoapp/krakend-influx\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"http://&lt;your-influx-db-server-ip>:8086\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"ttl\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"25s\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"buffer_size\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"github_com/devopsfaith/krakend-metrics\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"collection_time\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"30s\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"listen_address\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"127.0.0.1:8090\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h2 id=\"importing-the-grafana-dashboard\" style=\"position:relative;\"><a href=\"#importing-the-grafana-dashboard\" aria-label=\"importing the grafana dashboard permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Importing the Grafana Dashboard</h2>\n<ol>\n<li>\n<p>Go to the browser and open <code class=\"language-text\">http://localhost:3000</code>. Use <code class=\"language-text\">admin</code> for both username and password</p>\n</li>\n<li>\n<p>Click <code class=\"language-text\">Configuration</code> from the side menu and find the button to add the data source. Select InfluxDB as the database and fill in the details you provided when starting InfluxDB:</p>\n<ul>\n<li>Query Language: <code class=\"language-text\">InfluxQL</code></li>\n<li>URL: <code class=\"language-text\">http://localhost:8086</code></li>\n<li>Access: <code class=\"language-text\">Browser</code></li>\n<li>Database: <code class=\"language-text\">krakend</code></li>\n<li>User: <code class=\"language-text\">admin</code></li>\n<li>Password: <code class=\"language-text\">myadminpassword</code></li>\n<li>HTTP Method: <code class=\"language-text\">GET</code></li>\n</ul>\n</li>\n<li>\n<p>To import the dashboard: Click the <code class=\"language-text\">+</code> icon in the side menu from the Grafana interface and then click <code class=\"language-text\">Import</code>. Select <code class=\"language-text\">Import via Grafana.com</code>. Enter <code class=\"language-text\">5722</code> as the ID and click <code class=\"language-text\">Load</code>. Your dashboard is ready, enjoy it.</p>\n</li>\n</ol>\n<h2 id=\"resources\" style=\"position:relative;\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resources</h2>\n<ul>\n<li><a href=\"https://grafana.com/grafana/dashboards/5722\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">KrakenD Grafana Dashboard on Grafana.com</a></li>\n<li><a href=\"https://www.krakend.io/docs/extended-metrics/influxdb/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Native InfluxDB exporter</a></li>\n<li><a href=\"https://www.krakend.io/docs/extended-metrics/grafana/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Preconfigured Grafana dashboard</a></li>\n</ul>","timeToRead":3,"frontmatter":{"title":"KrakenD Monitoring with Grafana","date":"January 17, 2022","spoiler":"Monitor your KrakenD services with Grafana."},"fields":{"slug":"/krakend-monitoring-with-grafana/","langKey":"en"}}},"pageContext":{"slug":"/krakend-monitoring-with-grafana/","previous":{"fields":{"slug":"/elasticsearch-snapshots-to-minio/","langKey":"en","directoryName":"elasticsearch-snapshots-to-minio","maybeAbsoluteLinks":[]},"frontmatter":{"title":"Elasticsearch Snapshots to Minio"}},"next":{"fields":{"slug":"/how-to-use-apache-airflow/","langKey":"en","directoryName":"how-to-use-apache-airflow","maybeAbsoluteLinks":[]},"frontmatter":{"title":"How to Use Apache Airflow"}},"translations":["tr"],"translatedLinks":[]}},
    "staticQueryHashes": ["336482444"]}