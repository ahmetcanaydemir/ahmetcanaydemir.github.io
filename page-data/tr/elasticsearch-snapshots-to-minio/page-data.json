{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/tr/elasticsearch-snapshots-to-minio/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Ahmet Can Aydemir","author":"Ahmet Can Aydemir"}},"markdownRemark":{"id":"16398dcf-d775-5f4d-a248-2c159d0b6c14","html":"<p><a href=\"/x/\"></a></p>\n<p>Minio yüksek performanslı, self-hosted AWS S3 uyumlu object storage çözümüdür.</p>\n<p>Elasticsearch snapshotlarını Minio’da nasıl saklayabileceğimizi açıklayacağım.</p>\n<h2 id=\"ön-gereksinimler\" style=\"position:relative;\"><a href=\"#%C3%B6n-gereksinimler\" aria-label=\"ön gereksinimler permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ön gereksinimler</h2>\n<ul>\n<li>Minio</li>\n<li>Elasticsearch</li>\n</ul>\n<hr>\n<h2 id=\"bucket-oluşturma\" style=\"position:relative;\"><a href=\"#bucket-olu%C5%9Fturma\" aria-label=\"bucket oluşturma permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bucket Oluşturma</h2>\n<p>Öncelikle elasticsearch snapshotlarının depolanması için bir bucketa ihtiyacımız var.</p>\n<p>Minio UI console’u açıp sol menüden <strong>Buckets</strong>‘a girip <strong>Create Bucket</strong> ile bir bucket oluşturabilirsiniz.</p>\n<hr>\n<h2 id=\"service-account-oluşturma\" style=\"position:relative;\"><a href=\"#service-account-olu%C5%9Fturma\" aria-label=\"service account oluşturma permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Service Account Oluşturma</h2>\n<p>Elasticsearch ile minio bağlantısı kurmak için bir de servis hesabı gerekiyor.</p>\n<p>Minio UI console’u açıp sol menüden <strong>Service Accounts</strong>‘a girip <strong>Create Service Account</strong> ile service account oluşturabilirsiniz.</p>\n<p>Bu aşamada göreceğiniz <strong>Secret Key</strong> ve <strong>Access Key</strong>i kaydedin bu bilgileri plugin kurulumu sırasında kullanacağız.</p>\n<hr>\n<h2 id=\"elasticsearch-s3-repository-plugin-kurulumu\" style=\"position:relative;\"><a href=\"#elasticsearch-s3-repository-plugin-kurulumu\" aria-label=\"elasticsearch s3 repository plugin kurulumu permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elasticsearch S3 Repository Plugin Kurulumu</h2>\n<p>Minio, Amazon AWS S3 ile uyumlu olduğu için S3 repository plugin kullanacağız. Bunun için bütün elasticsearch nodelarına bağlanılır ve aşağıdaki adımlar uygulanır.</p>\n<p>Öncelikle aşağıdaki komut ile <code class=\"language-text\">repository-s3</code> plugini kurulur.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/usr/share/elasticsearch/bin/elasticsearch-plugin <span class=\"token function\">install</span> repository-s3</code></pre></div>\n<p>S3 plugini ile birlikte elasticsearch üzerinde default adında S3 client oluşmaktadır. Yapılacak işlemler bu\nkullanıcı üzerinden gerçekleştirilebilir. Snapshotların gönderileceği minio sunucusuna erişmek için gerekli olan <code class=\"language-text\">access_key</code> ve <code class=\"language-text\">secret_key</code> bilgileri default client’a tanımlanır.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/usr/share/elasticsearch/bin/elasticsearch-keystore <span class=\"token function\">add</span> s3.client.default.secret_key\n<span class=\"token comment\"># Secret key girilmesi beklenecek</span>\n\n/usr/share/elasticsearch/bin/elasticsearch-keystore <span class=\"token function\">add</span> s3.client.default.access_key\n<span class=\"token comment\"># Access key girilmesi beklenecek</span></code></pre></div>\n<p>Bu aşamadan sonra elasticsearch servisi yeniden başlatılmalıdır.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">systemctl restart elasticsearch</code></pre></div>\n<hr>\n<h2 id=\"elasticsearch-repository-ekleme\" style=\"position:relative;\"><a href=\"#elasticsearch-repository-ekleme\" aria-label=\"elasticsearch repository ekleme permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elasticsearch Repository Ekleme</h2>\n<p>Aşağıdaki gibi bir istek gönderilerek <code class=\"language-text\">my-minio-repository</code> isimli bir repository oluşturulabilir.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">PUT _snapshot/my-minio-repository <span class=\"token punctuation\">{</span>\n   <span class=\"token string\">\"type\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"s3\"</span>,\n   <span class=\"token string\">\"settings\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"client\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"default\"</span>,\n      <span class=\"token string\">\"bucket\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"elasticsearch-snapshots\"</span>,\n      <span class=\"token string\">\"endpoint\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"minio.example.com\"</span>,\n      <span class=\"token string\">\"path_style_access\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"true\"</span>,\n      <span class=\"token string\">\"protocol\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"http\"</span>\n   <span class=\"token punctuation\">}</span> \n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h2 id=\"elle-snapshot-alma\" style=\"position:relative;\"><a href=\"#elle-snapshot-alma\" aria-label=\"elle snapshot alma permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elle snapshot alma</h2>\n<p>Aşağıdaki gibi bir istek gönderilerek <code class=\"language-text\">my-first-snapshot</code> isimli bir snapshot elle alınabilir.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">PUT /_snapshot/my-minio-repository/my-first-snapshot?wait_for_completion<span class=\"token operator\">=</span>true</code></pre></div>\n<hr>\n<h2 id=\"policy-ile-snapshot-alma\" style=\"position:relative;\"><a href=\"#policy-ile-snapshot-alma\" aria-label=\"policy ile snapshot alma permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Policy ile snapshot alma</h2>\n<p>İstenirse snapshot alma işlemi <code class=\"language-text\">snapshot policy</code> kullanılarak otomatikleştirilebilir. Örneğin aşağıdaki policy her gün 07:30’da tüm indexlerin snapshotını minio repository’e kaydedecektir.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">PUT _slm/policy/daily-snapshots\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"name\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"&lt;daily-snapshot-{now/d}>\"</span>,\n    <span class=\"token string\">\"schedule\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"0 30 7 * * ?\"</span>,\n    <span class=\"token string\">\"repository\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"my-minio-repository\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h2 id=\"snapshotları-geri-yükleme\" style=\"position:relative;\"><a href=\"#snapshotlar%C4%B1-geri-y%C3%BCkleme\" aria-label=\"snapshotları geri yükleme permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Snapshotları geri yükleme</h2>\n<p>Aşağıdaki istek ile <code class=\"language-text\">my-first-snapshot</code> yedeği geri yüklenebilir.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">POST /_snapshot/my-minio-repository/my-first-snapshot/_restore</code></pre></div>\n<h2 id=\"kaynak\" style=\"position:relative;\"><a href=\"#kaynak\" aria-label=\"kaynak permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kaynak</h2>\n<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html</a></p>","timeToRead":2,"frontmatter":{"title":"Elasticsearch Snapshotlarını Minio'da Saklama","date":"December 23, 2021","spoiler":"Elasticsearch yedeklerinizi Minio'da tutun."},"fields":{"slug":"/tr/elasticsearch-snapshots-to-minio/","langKey":"tr"}}},"pageContext":{"slug":"/tr/elasticsearch-snapshots-to-minio/","translations":["tr"],"translatedLinks":[]}},
    "staticQueryHashes": ["336482444"]}