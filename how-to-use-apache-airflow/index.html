<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:inherit;border-left-color:inherit;opacity:0.8;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:var(--textLink);text-decoration:none;}a:hover,a:active{text-decoration:underline;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}p code{font-size:1rem;}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}blockquote.translation{font-size:1em;}</style><style data-href="/styles.76dcc336cb9d6b2f62b1.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:url(/static/merriweather-400-i-l-0f46d2fcc8d9674921cd07820a82ed6f.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:url(/static/merriweather-700-l-187d45eaf13b91cf608f3f673ea48f7e.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:url(/static/merriweather-700-i-l-82207a52271f9eac122012812b5d3a37.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:url(/static/merriweather-400-l-ext-7b4d7cd77c7be0ba465786a2b8bb74c9.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:url(/static/montserrat-900-l-ext-906692c68bf177b2067ba48c98ed4f52.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:url(/static/merriweather-400-i-l-ext-1bf3936986258f63a239a7f6054577bf.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:url(/static/merriweather-700-l-ext-cfb1dc4cd427eb7af0e01aa19b3d9bab.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:url(/static/merriweather-700-i-l-ext-1a225383926ba827fcf5113600464352.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:url(/static/merriweather-400-l-fd4fba424d435ed860722c314ec7b5e3.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:url(/static/montserrat-900-l-e6c80823afebb35e16f95ceb0f0be27e.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}.react-toggle{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;background-color:transparent;border:0;cursor:pointer;display:inline-block;padding:0;position:relative;touch-action:pan-x;-webkit-user-select:none;-ms-user-select:none;user-select:none}.react-toggle-screenreader-only{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.react-toggle-track{background-color:#0f1114;border-radius:30px;height:24px;padding:0;transition:all .2s ease;width:50px}.react-toggle-track-check{bottom:0;height:17px;left:5px;line-height:0;margin-bottom:auto;margin-top:auto;opacity:0;position:absolute;top:0;transition:opacity .25s ease;width:17px}.react-toggle--checked .react-toggle-track-check,.react-toggle-track-x{opacity:1;transition:opacity .25s ease}.react-toggle-track-x{bottom:0;height:17px;line-height:0;margin-bottom:auto;margin-top:auto;position:absolute;right:5px;top:0;width:17px}.react-toggle--checked .react-toggle-track-x{opacity:0}.react-toggle-thumb{background-color:#fafafa;border-radius:50%;box-sizing:border-box;height:22px;left:1px;position:absolute;top:1px;-webkit-transform:translateX(0);transform:translateX(0);transition:all .5s cubic-bezier(.23,1,.32,1) 0ms;width:22px}.react-toggle--checked .react-toggle-thumb{border-color:#19ab27;-webkit-transform:translateX(26px);transform:translateX(26px)}.react-toggle--focus .react-toggle-thumb{box-shadow:0 0 2px 3px #ffa7c4}.react-toggle:active .react-toggle-thumb{box-shadow:0 0 5px 5px #ffa7c4}body{--green:#28ab1c;background-color:var(--bg)}body.light{--bg:#fff;--bg-secondary:#f9fafb;--header:#1f871b;--textNormal:#222;--textTitle:#222;--textLink:#1f871b;--hr:rgba(0,0,0,.2);--inlineCode-bg:rgba(255,229,100,.2);--inlineCode-text:#1a1a1a;--form-shadow:0 2px 15px 0 rgba(210,214,220,.5)}body.dark{-webkit-font-smoothing:antialiased;--bg:#282c35;--bg-secondary:#363c48;--header:#fff;--textNormal:hsla(0,0%,100%,.88);--textTitle:#fff;--textLink:var(--green);--hr:hsla(0,0%,100%,.2);--inlineCode-bg:rgba(115,124,153,.2);--inlineCode-text:#e6e6e6;--form-shadow:0 2px 15px 0 rgba(26,26,27,.637)}body:lang(ar) article,body:lang(fa) article,body:lang(he) article{direction:rtl}body:lang(ar) .language-text,body:lang(ar) article .translations,body:lang(ar) article pre,body:lang(fa) .language-text,body:lang(fa) article .translations,body:lang(fa) article pre,body:lang(he) .language-text,body:lang(he) article .translations,body:lang(he) article pre{direction:ltr}body:lang(ar) .language-text,body:lang(fa) .language-text,body:lang(he) .language-text{display:inline-block}body:lang(ar) blockquote,body:lang(fa) blockquote,body:lang(he) blockquote{border-left:unset;border-right:.32813rem solid rgba(0,0,0,.9);margin-left:.75rem;margin-right:-1.75rem;padding-left:unset;padding-right:1.42188rem}body:lang(fa) article,body:lang(fa) header>h1{font-family:Vazir}body:lang(ar) article,body:lang(ar) header>h1{font-family:Cairo,sans-serif}body:lang(ko) article,body:lang(ko) header{word-break:keep-all}code[class*=language-],pre[class*=language-]{-webkit-font-feature-settings:normal;font-feature-settings:normal;word-wrap:normal;background:none;color:#fff;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{overflow:auto;padding:1.3125rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{background:hsla(0,0%,100%,.15);text-shadow:none}:not(pre)>code[class*=language-]{background:var(--inlineCode-bg);border-radius:.3em;color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;border-left:.25em solid #ffa7c4;display:block;padding-left:1.25em;padding-right:1em}.gatsby-highlight,.gatsby-highlight-code-line{margin-left:-1.3125rem;margin-right:-1.3125rem}.gatsby-highlight{-webkit-overflow-scrolling:touch;background:#011627;border-radius:10px;margin-bottom:1.75rem;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}.dropbtn{background-color:#4caf50;border:none;color:#fff;cursor:pointer;font-size:16px;padding:16px}.dropdown{display:inline-block;margin-bottom:0;position:relative}.dropdown-content{background-color:var(--bg-secondary);border-radius:16px;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);display:none;font-size:1rem;min-width:230px;position:absolute;z-index:1}.dropdown-content a{color:var(--textNormal);display:block;padding:4px 22px;text-decoration:none}.dropdown-content a:hover{background-color:var(--bg)}.dropdown-content a.selected{background-color:var(--bg);color:var(--textLink);pointer-events:none}.dropdown:hover .dropdown-content{display:block}.dropdown:hover:after{content:"";height:30px;left:0;position:absolute;top:calc(100% - 30px);width:230px}</style><meta name="generator" content="Gatsby 4.4.0"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Ahmet Can Aydemir&#x27;s Personal Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=478b5d01d3b7e74285a448d45abb5447" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=478b5d01d3b7e74285a448d45abb5447"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=478b5d01d3b7e74285a448d45abb5447"/><title data-react-helmet="true">How to Use Apache Airflow — Ahmet Can Aydemir</title><meta data-react-helmet="true" name="theme-color" content="#282c35"/><meta data-react-helmet="true" name="description" content="Basic introduction to Apache Airflow."/><meta data-react-helmet="true" property="og:url" content="https://ahmetcanaydemir.com/how-to-use-apache-airflow/"/><meta data-react-helmet="true" property="og:title" content="How to Use Apache Airflow"/><meta data-react-helmet="true" property="og:description" content="Basic introduction to Apache Airflow."/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@ahmetcnaydemir"/><meta data-react-helmet="true" name="twitter:title" content="How to Use Apache Airflow"/><meta data-react-helmet="true" name="twitter:description" content="Basic introduction to Apache Airflow."/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-3e6824a598c83c4c4292.js"/><link as="script" rel="preload" href="/framework-284342f1907d997d438f.js"/><link as="script" rel="preload" href="/app-79b145741620feb1a746.js"/><link as="script" rel="preload" href="/9c5c3b1714a076345eeea19da4bc8b5e8ba4ff9d-6099e8baeb69a0e60309.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-df63d68b93835c64993b.js"/><link as="fetch" rel="preload" href="/page-data/how-to-use-apache-airflow/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/336482444.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body class="light"><script>
              (function() {
                window.__onThemeChange = function() {};
                function setTheme(newTheme) {
                  window.__theme = newTheme;
                  preferredTheme = newTheme;
                  document.body.className = newTheme;
                  window.__onThemeChange(newTheme);
                }

                var preferredTheme;
                try {
                  preferredTheme = localStorage.getItem('theme');
                } catch (err) { }

                window.__setPreferredTheme = function(newTheme) {
                  setTheme(newTheme);
                  try {
                    localStorage.setItem('theme', newTheme);
                  } catch (err) {}
                }

                var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
                darkQuery.addListener(function(e) {
                  window.__setPreferredTheme(e.matches ? 'dark' : 'light')
                });

                setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
              })();
            </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="color:var(--textNormal);background:var(--bg);transition:color 0.2s ease-out, background 0.2s ease-out;min-height:100vh"><div style="margin-left:auto;margin-right:auto;max-width:48.75rem;padding:2.625rem 1.21875rem"><header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2.625rem"><div style="font-size:1.68179rem;line-height:2.4375rem;margin-bottom:0;margin-top:0;border:0"><a style="box-shadow:none;text-decoration:none;color:var(--textTitle);margin-right:5px" aria-label="Home" href="/"><svg aria-hidden="true" data-prefix="fas" width="20" height="20" data-icon="home" class="prefix__svg-inline--fa prefix__fa-home prefix__fa-w-18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0016 16l112.06-.29a16 16 0 0015.92-16V368a16 16 0 0116-16h64a16 16 0 0116 16v95.64a16 16 0 0016 16.05L464 480a16 16 0 0016-16V300L295.67 148.26a12.19 12.19 0 00-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 00-12-12h-56a12 12 0 00-12 12v72.61L318.47 43a48 48 0 00-61 0L4.34 251.47a12 12 0 00-1.6 16.9l25.5 31A12 12 0 0045.15 301l235.22-193.74a12.19 12.19 0 0115.3 0L530.9 301a12 12 0 0016.9-1.6l25.5-31a12 12 0 00-1.7-16.93z"></path></svg></a><div class="dropdown"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" cursor="pointer" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="prefix__feather prefix__feather-chevron-down"><path d="M6 9l6 6 6-6"></path></svg><div class="dropdown-content"><a class="false" href="/about">About</a><a class="false" href="/projects">Projects</a><a class="false" href="/books">Books</a><a class="false" href="/watched">Watched</a></div></div></div><div style="height:24px"></div></header><main><article><header><h1 style="color:var(--textTitle)">How to Use Apache Airflow</h1><p style="font-size:0.87055rem;line-height:1.625rem;display:block;margin-bottom:1.625rem;margin-top:-1.3rem">March 16, 2022<!-- --> • 10 min read</p><div class="translations"><div style="font-size:0.9em;border:1px solid var(--hr);border-radius:0.75em;padding:0.75em;background:var(--inlineCode-bg);word-break:keep-all;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"><span><span style="display:block">Written in:<!-- --> <b>English</b> • <a href="/tr/how-to-use-apache-airflow/">Türkçe</a></span></span></div></div></header><div><p><a href="/x/"></a></p>
<h2 id="what-is-apache-airflow" style="position:relative;"><a href="#what-is-apache-airflow" aria-label="what is apache airflow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Apache Airflow</h2>
<p>Airflow is an orchestration tool that ensures that tasks are running at the right time, in the correct order, and in the right way.</p>
<h3 id="why-you-need-apache-airflow" style="position:relative;"><a href="#why-you-need-apache-airflow" aria-label="why you need apache airflow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why You Need Apache Airflow</h3>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m9803a05zin2dg81g3gs.png" alt="ETL"></p>
<p>Imagine you have a data pipeline like the one above.</p>
<ul>
<li>What if an error occurs in any of these stages? There may be an error in the API from which you are pulling the data, there may be an error while processing the data, or there may be an error while saving to the DB.</li>
<li>If you have a lot of data pipelines like this, it will eventually become overwhelming.</li>
</ul>
<p>Roughly, as in the example above, taking the data from a source and saving it to the target after certain operations are called ETL (Extract Transform Load). Such transactions can be managed in an advanced way by using Airflow.</p>
<h3 id="benefits-of-apache-airflow" style="position:relative;"><a href="#benefits-of-apache-airflow" aria-label="benefits of apache airflow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Benefits of Apache Airflow</h3>
<p><strong>Dynamic:</strong> What can be done with Python also can be done with Airflow. As a result, Airflow provides tremendous dynamics when creating our tasks.</p>
<p><strong>Scalable:</strong> As many tasks as desired can be easily run in parallel.</p>
<p><strong>User Interface:</strong> Airflow has a useful UI. Errors that occur in data pipelines and where they occur can be easily observed. Problematic tasks can be restarted etc.</p>
<p><strong>Extensible:</strong> No need to wait for Airflow update when a new tool comes out. You can write your plugins and integrate them easily.</p>
<h3 id="apache-airflows-core-components" style="position:relative;"><a href="#apache-airflows-core-components" aria-label="apache airflows core components permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apache Airflow’s Core Components</h3>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/zqxxkmass3ie637tzjvd.png" alt="Airflow&#x27;s Core Components"></p>
<p><strong>Web Server:</strong> A Flask server that serves the UI.</p>
<p><strong>Scheduler:</strong> The daemon that schedules the workflows. It is the most important component of Airflow.</p>
<p><strong>Metastore:</strong> Database where metadata is stored.</p>
<p><strong>Executor:</strong> Class that defines how tasks should work.</p>
<p><strong>Worker:</strong> The process or sub-process executing the task.</p>
<h3 id="dag-directed-acyclic-graph" style="position:relative;"><a href="#dag-directed-acyclic-graph" aria-label="dag directed acyclic graph permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DAG (Directed Acyclic Graph)</h3>
<p>A DAG (Directed Acyclic Graph) is the core concept of Airflow, collecting Tasks together, organized with dependencies and relationships to say how they should run.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/mldbmor2s91ffb7ho5z5.png" alt="DAG"></p>
<ul>
<li>Example DAG above defines four Tasks - A, B, C, and D - and dictates the order in which they have to run, and which tasks depend on what others. It will also say how often to run the DAG - maybe “every 5 minutes starting tomorrow”, or “every day since January 1st, 2020”.</li>
<li>The DAG itself doesn’t care about <em>what</em> is happening inside the tasks; it is merely concerned with <em>how</em> to execute them - the order to run them in, how many times to retry them, if they have timeouts, and so on.</li>
</ul>
<p><strong>Basic DAG example</strong>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">with</span> DAG<span class="token punctuation">(</span><span class="token string">"my_dag_name"</span><span class="token punctuation">,</span>
		start_date<span class="token operator">=</span>datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    schedule_interval<span class="token operator">=</span><span class="token string">"@daily"</span><span class="token punctuation">,</span>
		catchup<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">as</span> dag<span class="token punctuation">:</span>
    op <span class="token operator">=</span> DummyOperator<span class="token punctuation">(</span>task_id<span class="token operator">=</span><span class="token string">"task"</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="operators" style="position:relative;"><a href="#operators" aria-label="operators permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Operators</h3>
<p>Operators are wrappers that cover the task. By default, there are many different types of operators and can be viewed at <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/index.html" target="_blank" rel="nofollow noopener noreferrer">this link</a>. In addition, <a href="https://airflow.apache.org/docs/apache-airflow-providers/operators-and-hooks-ref/index.html" target="_blank" rel="nofollow noopener noreferrer">much more</a> can be added as needed.</p>
<ol>
<li><strong>Action Operators:</strong> Operators which executes functions or commands eg. <code class="language-text">bash scripts</code>, <code class="language-text">python code</code></li>
<li><strong>Transfer Operators:</strong> Operators for moving data from source to destination eg. <code class="language-text">ElasticSearch to Mysql</code></li>
<li><strong>Sensor Operators:</strong> Operators which wait for something to happen before moving on to another task, eg. checking the file in the directory and continuing to the other task after that.</li>
</ol>
<h3 id="what-isnt-airflow" style="position:relative;"><a href="#what-isnt-airflow" aria-label="what isnt airflow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What Isn’t Airflow?</h3>
<p>Airflow is not a data streaming solution or data processing framework. If you need to process data every second, instead of using Airflow, Spark or Flink would be a better solution. If terabytes of data are being processed, it is recommended to run the Spark job with the operator in Airflow.</p>
<h2 id="apache-airflow-setup" style="position:relative;"><a href="#apache-airflow-setup" aria-label="apache airflow setup permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apache Airflow Setup</h2>
<p>Although Airflow can be installed with Docker, Kubernetes or different methods, in this article, we will install it locally.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># Airflow needs a home. `~/airflow` is the default, but you can put it</span>
<span class="token comment"># somewhere else if you prefer (optional)</span>
export AIRFLOW_HOME<span class="token operator">=</span><span class="token operator">~</span><span class="token operator">/</span>airflow

<span class="token comment"># Install Airflow using the constraints file. For this example, we will use Python 3.6 and Airflow 2.2.4</span>
pip install <span class="token string">"apache-airflow==${AIRFLOW_VERSION}"</span> <span class="token operator">-</span><span class="token operator">-</span>constraint <span class="token string">"https://raw.githubusercontent.com/apache/airflow/constraints-2.2.4/constraints-3.6.txt"</span>

<span class="token comment"># The Standalone command will initialize the database, make a user,</span>
<span class="token comment"># and start all components for you.</span>
airflow standalone

<span class="token comment"># Visit localhost:8080 in the browser and use the admin account details</span>
<span class="token comment"># shown on the terminal to login.</span>
<span class="token comment"># Enable the example_bash_operator dag on the home page</span></code></pre></div>
<h2 id="first-pipeline-with-apache-airflow" style="position:relative;"><a href="#first-pipeline-with-apache-airflow" aria-label="first pipeline with apache airflow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>First Pipeline with Apache Airflow</h2>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/l4of3ly2k0c3zaqi00o9.png" alt="Pipeline"></p>
<p>For example, let’s create a data pipeline like the one in the figure using Airflow. For this, let’s create a new python file in <code class="language-text">~/airflow/dags</code> directory eg: <code class="language-text">user_processing.py</code></p>
<h3 id="1-importing-modules" style="position:relative;"><a href="#1-importing-modules" aria-label="1 importing modules permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Importing Modules</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pandas <span class="token keyword">import</span> json_normalize

<span class="token comment"># DAG object; We will need this to create DAG</span>
<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG

<span class="token comment"># Operators</span>
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>sqlite <span class="token keyword">import</span> SqliteOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>http <span class="token keyword">import</span> SimpleHttpOperator

<span class="token comment"># Sensors</span>
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>sensors<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpSensor</code></pre></div>
<h3 id="2-instantiate-a-dag" style="position:relative;"><a href="#2-instantiate-a-dag" aria-label="2 instantiate a dag permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Instantiate a DAG</h3>
<p>We’ll need a DAG object to nest our tasks into. Here we pass a string that defines the <code class="language-text">dag_id</code>, which serves as a unique identifier for your DAG. We also pass a default argument dictionary and define a <code class="language-text">schedule_interval</code> of 1 day for the DAG.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">default_args <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'start_date'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">with</span> DAG<span class="token punctuation">(</span><span class="token string">'user_processing'</span><span class="token punctuation">,</span> schedule_interval<span class="token operator">=</span><span class="token string">'@daily'</span><span class="token punctuation">,</span>
        default_args<span class="token operator">=</span>default_args<span class="token punctuation">,</span>
        catchup<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

        <span class="token comment"># Define tasks/operators</span></code></pre></div>
<h3 id="3-creating-the-sqlite-table" style="position:relative;"><a href="#3-creating-the-sqlite-table" aria-label="3 creating the sqlite table permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Creating the SQLite Table</h3>
<p>We can use <code class="language-text">SqliteOperator</code> for this task. But <code class="language-text">SqliteOperator</code> will need a parameter named <code class="language-text">conn_id</code>, so first let’s create a connection for SQLite DB.</p>
<p>In Airflow, connections are kept in the metadata database. We will need to do the same for the <code class="language-text">HTTPOperator</code>.</p>
<p>We can use UI to create a connection</p>
<ol>
<li>Go to <a href="http://localhost:8080/connection/add" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/connection/add</a> (<strong>Admin / Connections / +</strong>)</li>
<li>Type <code class="language-text">Conn Id</code> field a unique name e.g.: <code class="language-text">db_sqlite</code></li>
<li>Select <code class="language-text">Conn Type</code> field as <code class="language-text">SQLite</code></li>
<li>In the <code class="language-text">Host</code> field, type the path to the SQLite database file. In this example, we can use Airflow’s metadata database instead of creating a new SQLite database file. <code class="language-text">/home/airflow/airflow.db</code></li>
<li>Save</li>
</ol>
<p>After this process, we can create the operator. Each operator must have a unique <code class="language-text">task_id</code>. SqliteOperator also has <code class="language-text">sqlite_conn_id</code> and <code class="language-text">sql</code> parameters. We will use the <code class="language-text">db_sqlite</code> as the sqlite_conn_id (see step 2).</p>
<p>In SQL code; if the <code class="language-text">users</code> table does not already exist; It creates a <code class="language-text">users</code> table with fields <code class="language-text">firstname</code>, <code class="language-text">lastname</code>, <code class="language-text">country</code>, <code class="language-text">username</code>, <code class="language-text">password</code> and <code class="language-text">email</code>.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"> creating_table <span class="token operator">=</span> SqliteOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'creating_table'</span><span class="token punctuation">,</span>
        sqlite_conn_id<span class="token operator">=</span><span class="token string">'db_sqlite'</span><span class="token punctuation">,</span>
        sql<span class="token operator">=</span><span class="token triple-quoted-string string">'''
            CREATE TABLE IF NOT EXISTS users (
                firstname TEXT NOT NULL,
                lastname TEXT NOT NULL,
                country TEXT NOT NULL,
                username TEXT NOT NULL,
                password TEXT NOT NULL,
                email TEXT NOT NULL PRIMARY KEY
            );
        '''</span> 
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="4-verify-api" style="position:relative;"><a href="#4-verify-api" aria-label="4 verify api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Verify API</h3>
<p>We can add a sensor to check if there is a problem with the API by making an HTTP request. <code class="language-text">HttpSensor</code> will be useful for this, but <code class="language-text">HttpSensor</code> needs <code class="language-text">http_conn_id</code> parameter. So we have to create a new connection as we did in the previous step. Unlike before, this time we will create a connection with <code class="language-text">HTTP</code> type, not an <code class="language-text">SQLite</code> type.</p>
<p>We can use UI to create a connection</p>
<ol>
<li>Go to <a href="http://localhost:8080/connection/add" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/connection/add</a> (<strong>Admin / Connections / +</strong>)</li>
<li>Type <code class="language-text">Conn Id</code> field a unique name e.g.: <code class="language-text">user_api</code></li>
<li>Select <code class="language-text">Conn Type</code> field as <code class="language-text">HTTP</code></li>
<li>In the <code class="language-text">Host</code> field, enter the address of the API that brings random users. eg. <a href="https://randomuser.me/" target="_blank" rel="nofollow noopener noreferrer">https://randomuser.me/</a></li>
<li>Save</li>
</ol>
<p>Now we can create the sensor. Since the API we use works at <code class="language-text">[https://randomuser.me/api/](https://randomuser.me/api)</code>, we used <code class="language-text">api/</code> in the endpoint parameter.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">is_api_available <span class="token operator">=</span> HttpSensor<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'is_api_available'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span>
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="5-retrieve-random-users-from-api" style="position:relative;"><a href="#5-retrieve-random-users-from-api" aria-label="5 retrieve random users from api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. Retrieve Random Users from API</h3>
<p>With using <code class="language-text">SimpleHttpOperator</code> we send a <code class="language-text">GET</code> HTTP request to the <code class="language-text">user_api</code> connection we created before. With <code class="language-text">response_filter</code> we convert the JSON string in the <code class="language-text">response.text</code> field into a python object.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"> extracting_user <span class="token operator">=</span> SimpleHttpOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'extracting_user'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span><span class="token punctuation">,</span>
        method<span class="token operator">=</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
        response_filter<span class="token operator">=</span><span class="token keyword">lambda</span> response<span class="token punctuation">:</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>
        log_response<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="6-processing-the-api-result" style="position:relative;"><a href="#6-processing-the-api-result" aria-label="6 processing the api result permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. Processing the API Result</h3>
<p>With using <code class="language-text">PythonOperator</code>, we will keep only the desired fields of the python object that we obtained in step 5. And we will save the result as csv file.</p>
<p>Any python function can be run directly with the <code class="language-text">python_callable</code> parameter.</p>
<p>The important part here is how we will get the response from the previous section. For this, we can send the <code class="language-text">task instance (ti)</code> object as a parameter to the python function and get the results of the <code class="language-text">task_ids</code> with <code class="language-text">users = ti.xcom_pull(task_ids=['extracting_user'])</code>.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">processing_user <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'processing_user'</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>_processing_user
    <span class="token punctuation">)</span>

<span class="token comment"># Somewhere outside the scope of DAG</span>
<span class="token keyword">def</span> <span class="token function">_processing_user</span><span class="token punctuation">(</span>ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    users <span class="token operator">=</span> ti<span class="token punctuation">.</span>xcom_pull<span class="token punctuation">(</span>task_ids<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'extracting_user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">len</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'results'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'User is empty'</span><span class="token punctuation">)</span>
    user <span class="token operator">=</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'results'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    processed_user <span class="token operator">=</span> json_normalize<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'firstname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'lastname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'last'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'country'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'email'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    processed_user<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/tmp/processed_user.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="7-saving-processed-users-to-sqlite-db" style="position:relative;"><a href="#7-saving-processed-users-to-sqlite-db" aria-label="7 saving processed users to sqlite db permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. Saving Processed Users to SQLite DB</h3>
<p>We can use <code class="language-text">BashOperator</code> for trying new operators. <code class="language-text">BashOperator</code> allows us to run bash commands.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">storing_user <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'storing_user'</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">'echo -e ".separator ","\n.import /tmp/processed_user.csv users" | sqlite3 /home/airflow/airflow/airflow.db'</span>
    <span class="token punctuation">)</span></code></pre></div>
<h3 id="8-relationship-between-tasks" style="position:relative;"><a href="#8-relationship-between-tasks" aria-label="8 relationship between tasks permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. Relationship Between Tasks</h3>
<p>Simply, the direction of the tasks and their connection with each other can be defined as follows.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># Somewhere outside the scope of DAG</span>
creating_table <span class="token operator">>></span> is_api_available <span class="token operator">>></span> extracting_user <span class="token operator">>></span> processing_user <span class="token operator">>></span> storing_user</code></pre></div>
<h3 id="final-dag-file" style="position:relative;"><a href="#final-dag-file" aria-label="final dag file permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Final DAG File</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pandas <span class="token keyword">import</span> json_normalize

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG

<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>sqlite <span class="token keyword">import</span> SqliteOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>http <span class="token keyword">import</span> SimpleHttpOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>providers<span class="token punctuation">.</span>http<span class="token punctuation">.</span>sensors<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpSensor

default_args <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'start_date'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">_processing_user</span><span class="token punctuation">(</span>ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    users <span class="token operator">=</span> ti<span class="token punctuation">.</span>xcom_pull<span class="token punctuation">(</span>task_ids<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'extracting_user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">len</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'results'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'User is empty'</span><span class="token punctuation">)</span>
    user <span class="token operator">=</span> users<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'results'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    processed_user <span class="token operator">=</span> json_normalize<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'firstname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'lastname'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'last'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'country'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'email'</span><span class="token punctuation">:</span> user<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    processed_user<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/tmp/processed_user.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    

<span class="token keyword">with</span> DAG<span class="token punctuation">(</span><span class="token string">'user_processing'</span><span class="token punctuation">,</span> schedule_interval<span class="token operator">=</span><span class="token string">'@daily'</span><span class="token punctuation">,</span>
        default_args<span class="token operator">=</span>default_args<span class="token punctuation">,</span>
        catchup<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>
        <span class="token comment"># Define tasks/operators</span>
        
    creating_table <span class="token operator">=</span> SqliteOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'creating_table'</span><span class="token punctuation">,</span>
        sqlite_conn_id<span class="token operator">=</span><span class="token string">'db_sqlite'</span><span class="token punctuation">,</span>
        sql<span class="token operator">=</span><span class="token triple-quoted-string string">'''
            CREATE TABLE IF NOT EXISTS users (
                firstname TEXT NOT NULL,
                lastname TEXT NOT NULL,
                country TEXT NOT NULL,
                username TEXT NOT NULL,
                password TEXT NOT NULL,
                email TEXT NOT NULL PRIMARY KEY
            );
        '''</span> 
    <span class="token punctuation">)</span>
    
    is_api_available <span class="token operator">=</span> HttpSensor<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'is_api_available'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span>
    <span class="token punctuation">)</span>
    
    extracting_user <span class="token operator">=</span> SimpleHttpOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'extracting_user'</span><span class="token punctuation">,</span>
        http_conn_id<span class="token operator">=</span><span class="token string">'user_api'</span><span class="token punctuation">,</span>
        endpoint<span class="token operator">=</span><span class="token string">'api/'</span><span class="token punctuation">,</span>
        method<span class="token operator">=</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
        response_filter<span class="token operator">=</span><span class="token keyword">lambda</span> response<span class="token punctuation">:</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>
        log_response<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span>
    
    processing_user <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'processing_user'</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>_processing_user
    <span class="token punctuation">)</span>
    
    storing_user <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">'storing_user'</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">'echo -e ".separator ","\n.import /tmp/processed_user.csv users" | sqlite3 /home/airflow/airflow/airflow.db'</span>
    <span class="token punctuation">)</span>
    
creating_table <span class="token operator">>></span> is_api_available <span class="token operator">>></span> extracting_user <span class="token operator">>></span> processing_user <span class="token operator">>></span> storing_user</code></pre></div>
<h2 id="conclusion" style="position:relative;"><a href="#conclusion" aria-label="conclusion permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>
<p>To understand the concept, we have defined a simple and parallelism-free data pipeline. Much more complex, parallel tasks also can be created using Airflow. Thank you for reading!</p>
<h2 id="screenshots" style="position:relative;"><a href="#screenshots" aria-label="screenshots permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Screenshots</h2>
<details>
<summary markdown="span">Show Screenshots</summary>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/a3a0r96acrkak6cfceck.png" alt="Graph View"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gc2uehcap4a2azidlppc.png" alt="Tree View"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/j68phdyzzbll0wfx7q6q.png" alt="Gantt"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/5vjunmrg6fd6gq0gg5wi.png" alt="Log"></p>
<hr>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m6rb1hz3e4qs1pmdpc53.png" alt="Homepage"></p>
</details>
<h2 id="references" style="position:relative;"><a href="#references" aria-label="references permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>References</h2>
<ul>
<li><a href="https://www.udemy.com/course/the-complete-hands-on-course-to-master-apache-airflow/" target="_blank" rel="nofollow noopener noreferrer">The Complete Hands-On Introduction to Apache Airflow by Marc Lamberti</a></li>
<li><a href="https://airflow.apache.org/docs/" target="_blank" rel="nofollow noopener noreferrer">Apache Airflow Docs</a></li>
</ul></div><footer></footer></article></main><aside><div style="margin:90px 0 40px 0;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"></div><div style="display:flex;margin-bottom:3.25rem"><img src="/static/profile-pic-a7e6f09e74346211c0c48d9c8b0ae26a.jpg" alt="Ahmet Can Aydemir" style="margin-bottom:0;margin-right:0.8125rem;width:3.25rem;height:3.25rem;border-radius:50%"/><p style="max-width:420px">Personal blog by<!-- --> <a href="https://mobile.twitter.com/ahmetcnaydemir">Ahmet Can Aydemir</a>.<br/>My thoughts about Programming and things.</p></div><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" style="margin-right:20px" href="/krakend-monitoring-with-grafana/">← <!-- -->KrakenD Monitoring with Grafana</a></li><li></li></ul></nav></aside></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-43958449-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/how-to-use-apache-airflow/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2a3acc3892700f85b191.js"],"app":["/app-79b145741620feb1a746.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-12da092de1793550498c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-ca4f78e840fcfaf7f05a.js"],"component---src-pages-about-js":["/component---src-pages-about-js-da8003aeb26351f99553.js"],"component---src-pages-books-js":["/component---src-pages-books-js-b43bfadf0976e5ca2342.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-3e70832ee8814a613cfb.js"],"component---src-pages-watched-js":["/component---src-pages-watched-js-1926a3dcc88594250442.js"],"component---src-templates-blog-index-js":["/component---src-templates-blog-index-js-4ac3d528c3efe67e9d5b.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-df63d68b93835c64993b.js"]};/*]]>*/</script><script src="/polyfill-2a3acc3892700f85b191.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-df63d68b93835c64993b.js" async=""></script><script src="/9c5c3b1714a076345eeea19da4bc8b5e8ba4ff9d-6099e8baeb69a0e60309.js" async=""></script><script src="/app-79b145741620feb1a746.js" async=""></script><script src="/framework-284342f1907d997d438f.js" async=""></script><script src="/webpack-runtime-3e6824a598c83c4c4292.js" async=""></script></body></html>